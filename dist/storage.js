"use strict";function isDef(e){return void 0!==e&&null!==e}function getObjectType(e){return Object.prototype.toString.call(e).slice(8,-1)}function tip(e){"undefined"!=typeof console&&console.warn("[Tip]: "+e)}function selectStorage(e){return"s"===e||"session"===e||"SS"===e?SS:LS}function Storage(e){if(e=e||{},"String"===getObjectType(e))this.defaults={use:e,pre:"",strict:!0,expire:null};else{if("Object"!==getObjectType(e))throw new Error("Wrong storage option");this.defaults={use:e.use,pre:"String"===getObjectType(e.pre)?e.pre:"",strict:"Boolean"!==getObjectType(e.strict)||e.strict,expire:"Number"===getObjectType(e.expire)?e.expire:null}}this.$storage=selectStorage(this.defaults.use)}var LS=window.localStorage,SS=window.sessionStorage;Storage.prototype.useTemporary=function(e){return"Object"===getObjectType(e)&&(e.strict||!e.strict&&this.defaults.strict)},Storage.prototype.key=function(e,t){return this.useTemporary(t)&&"String"===getObjectType(t.pre)?""+t.pre+e:""+this.defaults.pre+e},Storage.prototype.storage=function(e){return this.useTemporary(e)&&"String"===getObjectType(e.use)?selectStorage(this.defaults,e):this.$storage},Storage.prototype.pre=function(e){return this.useTemporary(e)&&"String"===getObjectType(e.pre)?e.pre:this.defaults.pre},Storage.prototype.get=function(e,t){if(isDef(e)){e=this.key(e,t);var r=this.storage(t);if(this.useTemporary(t)){var i=r.getItem(e);if(null===i)return null;try{return(i=JSON.parse(i)).expire&&i.expire>(new Date).getTime()||null===i.expire?i.data:(r.removeItem(e),null)}catch(t){r.removeItem(e),tip("Wrong get storage")}}else if(this.defaults.strict){var o=r.getItem(e);if(null===o)return null;try{return(o=JSON.parse(o)).expire&&o.expire>(new Date).getTime()||null===o.expire?o.data:(r.removeItem(e),null)}catch(t){r.removeItem(e),tip("Wrong get storage")}}else try{return JSON.parse(r.getItem(e))}catch(t){return r.getItem(e)}}else tip("Wrong get storage")},Storage.prototype.set=function(e,t,r){if(Array.isArray(e))for(var i in e)this._set(e[i].key,e[i].value,t);else this._set(e,t,r)},Storage.prototype.remove=function(e,t){if(Array.isArray(e))for(var r in e)this._remove(e[r],t);else this._remove(e,t)},Storage.prototype.clear=function(e){var t=this.pre(e);if(t){for(var r in LS)0===r.indexOf(t)&&LS.removeItem(r);for(var i in SS)0===i.indexOf(t)&&SS.removeItem(i)}else SS.clear(),LS.clear()},Storage.prototype._set=function(e,t,r){if(isDef(e)){e=this.key(e,r);var i=this.storage(r);isDef(t)?this.useTemporary(r)?i.setItem(e,JSON.stringify({data:t,expire:r.expire||null,type:getObjectType(t)})):this.defaults.strict?i.setItem(e,JSON.stringify({data:t,expire:this.defaults.expire,type:getObjectType(t)})):i.setItem(e,"String"===getObjectType(t)||"Number"===getObjectType(t)?t:JSON.stringify(t)):i.removeItem(e)}else tip("Wrong set storage")},Storage.prototype._remove=function(e,t){e?this.storage(t).removeItem(this.key(e,t)):tip("Wrong remove storage")},exports.default=Storage;