"use strict";function isDef(e){return void 0!==e&&null!==e}function getObjectType(e){return Object.prototype.toString.call(e).slice(8,-1)}function tip(e){"undefined"!=typeof console&&console.warn("[Tip]: "+e)}function Storages(e){if(e=e||{},"String"===getObjectType(e))this.defaults={use:e,pre:"",strict:!0,expire:null};else{if("Object"!==getObjectType(e))throw new Error("Wrong storage config");this.defaults={use:e.use,pre:"String"===getObjectType(e.pre)?e.pre:"",strict:"Boolean"!==getObjectType(e.strict)||e.strict,expire:"Number"===getObjectType(e.expire)?e.expire:null}}this.$storage=/^(s|session|sessionStorage)$/.test(this.defaults.use)?SS:LS}var LS=window.localStorage,SS=window.sessionStorage;Storages.prototype.useTemporary=function(e){return"Object"===getObjectType(e)&&(e.strict||!e.strict&&this.defaults.strict)},Storages.prototype.key=function(e,t){return this.useTemporary(t)&&"String"===getObjectType(t.pre)?""+t.pre+e:""+this.defaults.pre+e},Storages.prototype.storage=function(e){return this.useTemporary(e)&&"String"===getObjectType(e.use)?/^(s|session|sessionStorage)$/.test(e.use)?SS:LS:this.$storage},Storages.prototype.pre=function(e){return this.useTemporary(e)&&"String"===getObjectType(e.pre)?e.pre:this.defaults.pre},Storages.prototype.get=function(e,t){if(isDef(e)){e=this.key(e,t);var r=this.storage(t);if(this.useTemporary(t)){var s=r.getItem(e);if(null===s)return null;try{return(s=JSON.parse(s)).expire&&s.expire>(new Date).getTime()||null===s.expire?s.data:(r.removeItem(e),null)}catch(t){r.removeItem(e),tip("Wrong get storage")}}else if(this.defaults.strict){var i=r.getItem(e);if(null===i)return null;try{return(i=JSON.parse(i)).expire&&i.expire>(new Date).getTime()||null===i.expire?i.data:(r.removeItem(e),null)}catch(t){r.removeItem(e),tip("Wrong get storage")}}else try{return JSON.parse(r.getItem(e))}catch(t){return r.getItem(e)}}else tip("Wrong get storage")},Storages.prototype.set=function(e,t,r){if(Array.isArray(e))for(var s in e)this._set(e[s].key,e[s].value,t);else this._set(e,t,r)},Storages.prototype.remove=function(e,t){if(Array.isArray(e))for(var r in e)this._remove(e[r],t);else this._remove(e,t)},Storages.prototype.clear=function(e){var t=this.pre(e);if(t){for(var r in LS)0===r.indexOf(t)&&LS.removeItem(r);for(var s in SS)0===s.indexOf(t)&&SS.removeItem(s)}else SS.clear(),LS.clear()},Storages.prototype._set=function(e,t,r){if(isDef(e)){e=this.key(e,r);var s=this.storage(r);isDef(t)?this.useTemporary(r)?s.setItem(e,JSON.stringify({data:t,expire:r.expire||null,type:getObjectType(t)})):this.defaults.strict?s.setItem(e,JSON.stringify({data:t,expire:this.defaults.expire,type:getObjectType(t)})):s.setItem(e,"String"===getObjectType(t)||"Number"===getObjectType(t)?t:JSON.stringify(t)):s.removeItem(e)}else tip("Wrong set storage")},Storages.prototype._remove=function(e,t){e?this.storage(t).removeItem(this.key(e,t)):tip("Wrong remove storage")},exports.default=new Storages;